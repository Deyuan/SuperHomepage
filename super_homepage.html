<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="author" content="Deyuan Guo, Chong Tang">
  <title>Super Homepage</title>
  <style type="text/css">
    body {
      width: 1300px;
      font-size: 14px;
    }
    div.column {
      width: 210px;
      position: relative;
      float: left;
      padding: 0px 0px 20px 0px;
      margin: 0px 2px 10px 0px;
      border-style: dotted;
      border-color: #EEEEEE;
      border-width: 1px;
    }
    div.category {
      width: 200px;
      position: relative;
      float: left;
      padding: 0px;
      margin: 4px 4px 8px 4px;
      border-style: solid;
      border-color: grey;
      border-width: 1px;
      box-shadow: 1px 1px 1px lightgrey;
    }
    h1 {
      padding: 1px 0px 1px 7px;
      margin: 0px 0px 5px 0px;
      background-color: #EEEEEE;
      border-bottom-style: solid;
      border-bottom-color: grey;
      border-bottom-width: 1px;
      font-size: 14px;
      text-align: left;
      word-wrap: break-word;
    }
    i {
      -webkit-transition: opacity .2s;
      transition: opacity .2s;
      opacity: 0;
      cursor: pointer;
      font-style: normal;
      font-family: fantasy;
      position: absolute;
    }
    h1:hover i {
      opacity: 1;
    }
    i.del_cate {
      color: #AA0000;
      top: 2px;
      right: 3px;
    }
    i.add_bmk {
      color: #00AA00;
      top: 2px;
      right: 18px;
    }
    i.rename_cate {
      color: #0000AA;
      top: 2px;
      right: 33px;
    }
    ul.bmk_list {
      list-style-type: none;
      padding: 0px 5px 0px 5px;
      margin: 0px;
      border-style: solid;
      border-color: white;
      border-width: 1px;
    }
    li {
      position: relative;
      padding: 1px 2px 1px 2px;
      margin: 0px 0px 5px 0px;
      background-color: white;
      border-width: thin;
      border-style: solid;
      border-color: grey;
      box-shadow: 1px 1px 1px lightgrey;
      word-wrap: break-word;
    }
    i.del_bmk {
      color: #AA0000;
      top: 2px;
      right: 3px;
    }
    li:hover i {
      opacity: 1;
    }
    div.footer {
      background-color:lightgrey;
      clear:both;
      text-align:center;
      position: fixed;
      bottom: 0;
      right: 0;
      padding:10px;
    }
  </style>
</head>

<body>
  <div class="column">
    <div class="category">
      <h1>
        Popular
        <i class="rename_cate" onclick="renameCategory(this)">✎</i>
        <i class="add_bmk" onclick="addBookmark(this)">✚</i>
        <i class="del_cate">✖</i>
      </h1>
      <ul class="bmk_list">
        <li> <a href="https://www.google.com">Google</a> <i class="del_bmk">✖</i></li>
        <li> <a href="http://www.facebook.com">Facebook</a> <i class="del_bmk">✖</i></li>
        <li> <a href="https://www.amazon.com">Amazon</a> <i class="del_bmk">✖</i></li>
        <li> <a href="http://www.linkedin.com">LinkedIn</a> <i class="del_bmk">✖</i></li>
        <li> <a href="http://www.apple.com">Apple</a> <i class="del_bmk">✖</i></li>
      </ul>
    </div>
  </div>

  <div class="column">
    <div class="category">
      <h1>
        Programming
        <i class="rename_cate" onclick="renameCategory(this)">✎</i>
        <i class="add_bmk" onclick="addBookmark(this)">✚</i>
        <i class="del_cate">✖</i>
      </h1>
      <ul class="bmk_list">
        <li> <a href="http://github.com">Github</a> <i class="del_bmk">✖</i></li>
        <li> <a href="http://codechef.com">Codechef</a> <i class="del_bmk">✖</i></li>
        <li> <a href="http://codeforces.com">Codeforces</a> <i class="del_bmk">✖</i></li>
      </ul>
    </div>
  </div>

  <div class="column">
    <div class="category">
      <h1>
        UVa
        <i class="rename_cate" onclick="renameCategory(this)">✎</i>
        <i class="add_bmk" onclick="addBookmark(this)">✚</i>
        <i class="del_cate">✖</i>
      </h1>
      <ul class="bmk_list">
        <li> <a href="http://www.virginia.edu">University of Virginia</a><i class="del_bmk">✖</i></li>
        <li> <a href="http://www.cs.virginia.edu">UVa CS</a> <i class="del_bmk">✖</i></li>
      </ul>
    </div>
  </div>

  <div class="column">
  </div>

  <div class="column">
  </div>

  <div class="column">
  </div>

  <div class="footer">
    <button id="btnAddCategory">Add New Category</button>
    <button id="btnSaveAs">Save As Html...</button>
  </div>

  <script>
    /*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */
    var saveAs=saveAs||function(view){"use strict";if(typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){return}var doc=view.document,get_URL=function(){return view.URL||view.webkitURL||view},save_link=doc.createElementNS("http://www.w3.org/1999/xhtml","a"),can_use_save_link="download"in save_link,click=function(node){var event=new MouseEvent("click");node.dispatchEvent(event)},is_safari=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),webkit_req_fs=view.webkitRequestFileSystem,req_fs=view.requestFileSystem||webkit_req_fs||view.mozRequestFileSystem,throw_outside=function(ex){(view.setImmediate||view.setTimeout)(function(){throw ex},0)},force_saveable_type="application/octet-stream",fs_min_size=0,arbitrary_revoke_timeout=500,revoke=function(file){var revoker=function(){if(typeof file==="string"){get_URL().revokeObjectURL(file)}else{file.remove()}};if(view.chrome){revoker()}else{setTimeout(revoker,arbitrary_revoke_timeout)}},dispatch=function(filesaver,event_types,event){event_types=[].concat(event_types);var i=event_types.length;while(i--){var listener=filesaver["on"+event_types[i]];if(typeof listener==="function"){try{listener.call(filesaver,event||filesaver)}catch(ex){throw_outside(ex)}}}},auto_bom=function(blob){if(/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(blob.type)){return new Blob(["\ufeff",blob],{type:blob.type})}return blob},FileSaver=function(blob,name,no_auto_bom){if(!no_auto_bom){blob=auto_bom(blob)}var filesaver=this,type=blob.type,blob_changed=false,object_url,target_view,dispatch_all=function(){dispatch(filesaver,"writestart progress write writeend".split(" "))},fs_error=function(){if(target_view&&is_safari&&typeof FileReader!=="undefined"){var reader=new FileReader;reader.onloadend=function(){var base64Data=reader.result;target_view.location.href="data:attachment/file"+base64Data.slice(base64Data.search(/[,;]/));filesaver.readyState=filesaver.DONE;dispatch_all()};reader.readAsDataURL(blob);filesaver.readyState=filesaver.INIT;return}if(blob_changed||!object_url){object_url=get_URL().createObjectURL(blob)}if(target_view){target_view.location.href=object_url}else{var new_tab=view.open(object_url,"_blank");if(new_tab==undefined&&is_safari){view.location.href=object_url}}filesaver.readyState=filesaver.DONE;dispatch_all();revoke(object_url)},abortable=function(func){return function(){if(filesaver.readyState!==filesaver.DONE){return func.apply(this,arguments)}}},create_if_not_found={create:true,exclusive:false},slice;filesaver.readyState=filesaver.INIT;if(!name){name="download"}if(can_use_save_link){object_url=get_URL().createObjectURL(blob);setTimeout(function(){save_link.href=object_url;save_link.download=name;click(save_link);dispatch_all();revoke(object_url);filesaver.readyState=filesaver.DONE});return}if(view.chrome&&type&&type!==force_saveable_type){slice=blob.slice||blob.webkitSlice;blob=slice.call(blob,0,blob.size,force_saveable_type);blob_changed=true}if(webkit_req_fs&&name!=="download"){name+=".download"}if(type===force_saveable_type||webkit_req_fs){target_view=view}if(!req_fs){fs_error();return}fs_min_size+=blob.size;req_fs(view.TEMPORARY,fs_min_size,abortable(function(fs){fs.root.getDirectory("saved",create_if_not_found,abortable(function(dir){var save=function(){dir.getFile(name,create_if_not_found,abortable(function(file){file.createWriter(abortable(function(writer){writer.onwriteend=function(event){target_view.location.href=file.toURL();filesaver.readyState=filesaver.DONE;dispatch(filesaver,"writeend",event);revoke(file)};writer.onerror=function(){var error=writer.error;if(error.code!==error.ABORT_ERR){fs_error()}};"writestart progress write abort".split(" ").forEach(function(event){writer["on"+event]=filesaver["on"+event]});writer.write(blob);filesaver.abort=function(){writer.abort();filesaver.readyState=filesaver.DONE};filesaver.readyState=filesaver.WRITING}),fs_error)}),fs_error)};dir.getFile(name,{create:false},abortable(function(file){file.remove();save()}),abortable(function(ex){if(ex.code===ex.NOT_FOUND_ERR){save()}else{fs_error()}}))}),fs_error)}),fs_error)},FS_proto=FileSaver.prototype,saveAs=function(blob,name,no_auto_bom){return new FileSaver(blob,name,no_auto_bom)};if(typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob){return function(blob,name,no_auto_bom){if(!no_auto_bom){blob=auto_bom(blob)}return navigator.msSaveOrOpenBlob(blob,name||"download")}}FS_proto.abort=function(){var filesaver=this;filesaver.readyState=filesaver.DONE;dispatch(filesaver,"abort")};FS_proto.readyState=FS_proto.INIT=0;FS_proto.WRITING=1;FS_proto.DONE=2;FS_proto.error=FS_proto.onwritestart=FS_proto.onprogress=FS_proto.onwrite=FS_proto.onabort=FS_proto.onerror=FS_proto.onwriteend=null;return saveAs}(typeof self!=="undefined"&&self||typeof window!=="undefined"&&window||this.content);if(typeof module!=="undefined"&&module.exports){module.exports.saveAs=saveAs}else if(typeof define!=="undefined"&&define!==null&&define.amd!=null){define([],function(){return saveAs})}
    /*! Ply 0.5.0 - MIT | git://github.com/rubaxa/Ply.git */
    !function(a){"use strict";"function"==typeof define&&define.amd?define(a):window.Ply=a()}(function(){"use strict";function a(a){if(P)return new P(a);var b=M.Deferred();return a(b.resolve,b.reject),b}function b(a){return P?P.all(a):M.when.apply(M,a)}function c(b){return a(function(a){return a(b)})}function d(a){return a&&a.then?a:c(a)}function e(a){return"function"==typeof a}function f(a,b){if(a)for(var c in a)a.hasOwnProperty(c)&&b(a[c],c,a)}function g(a){var b={};return f(a,function(a,c){b[c]=e(a)?a:a instanceof Object?g(a):a}),b}function h(a){for(var b=Array.prototype.slice,c=b.call(arguments,1),d=0,e=c.length;e>d;d++)f(c[d],function(b,c){a[c]=b});return a}function i(a,b){try{return(b||G).querySelector(a)}catch(c){return M(a,b)[0]}}function j(a,b){return a.getElementsByTagName(b)}function k(a,b){try{a&&b&&a.appendChild(b)}catch(c){}}function l(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function m(a,b,c){var d=c.handle=c.handle||function(b){b.target||(b.target=b.srcElement||G),3===b.target.nodeType&&(b.target=b.target.parentNode),b.preventDefault||(b.preventDefault=function(){b.returnValue=!1}),b.stopPropagation||(b.stopPropagation=function(){b.cancelBubble=!0}),c.call(a,b)};a.addEventListener?a.addEventListener(b,d,!1):a.attachEvent("on"+b,d)}function n(a,b,c){var d=c.handle;d&&(a.removeEventListener?a.removeEventListener(b,d,!1):a.detachEvent("on"+b,d))}function o(a){if(null==a&&(a="div"),a.appendChild)return a;if(a.skip)return G.createDocumentFragment();"string"==typeof a&&(a={tag:a});var b,c=a.children,d=R.exec(a.tag||"");return delete a.children,a.tag=d[1]||"div",a.id=a.id||(d[2]||"").substr(1),d=(d[3]||"").split("."),d[0]=a.className||"",a.className=d.join(" "),b=G.createElement(a.tag),delete a.tag,f(a,function(c,d){if(c)if("css"===d)r(b,a.css);else if("text"===d)null!=c&&k(b,G.createTextNode(c));else if("html"===d)null!=c&&(b.innerHTML=c);else if("ply"===d)b.setAttribute(L,c);else if(d in b)try{b[d]=c}catch(e){b.setAttribute(d,c)}else/^data-/.test(d)&&b.setAttribute(d,c)}),c&&c.appendChild?k(b,c):f(c,function(a,c){a&&("string"==typeof a?a={text:a}:"object"!=typeof a&&(a={}),"string"==typeof c&&(a.tag=a.tag||c),k(b,o(a)))}),b}function p(a){for(var b,c,d=j(a,"input"),e=0,f=d.length;f>e;e++)if(b=d[e],"submit"===b.type)!c&&(c=b);else if(!/hidden|check|radio/.test(b.type)&&""==b.value){c=b;break}c||(c=j(a,"button")[0]);try{c.focus()}catch(g){}}function q(b){return s(!0),a(function(a){for(var c,d=j(b,"img"),e=d.length,f=e,g=function(){if(--f<=0){for(e=d.length;e--;)c=d[e],n(c,"load",g),n(c,"error",g);s(!1),a()}};e--;)c=d[e],c.complete?f--:(m(c,"load",g),m(c,"error",g));!f&&g()})}function r(a,b,c){if(a&&a.style&&b)if(b instanceof Object)for(var d in b)r(a,d,b[d]);else{if(void 0===c)return G.defaultView&&G.defaultView.getComputedStyle?c=G.defaultView.getComputedStyle(a,""):a.currentStyle&&(c=a.currentStyle),void 0===b?c:c[b];S[b]?S[b](a.style,c):a.style[J[b]||b]=c}}function s(a){var b=s.get();clearTimeout(s.pid),s.pid=a?H(function(){k(G.body,b)},100):H(function(){l(b)},100)}function t(a,b){return o({css:{padding:"20px 20px 40px",display:"inline-block",position:"relative",textAlign:"left",whiteSpace:"normal",verticalAlign:"middle",transform:"translate3d(0, 0, 0)"},children:b.baseHtml?[{ply:":layer",tag:".ply-layer",className:b.mod,css:h({overflow:"hidden",position:"relative",backfaceVisibility:"hidden"},b.layer),children:[b.flags.closeBtn&&{ply:":close",tag:".ply-x",text:I.cross},{tag:".ply-inside",children:a}]}]:a})}function u(a){return o({ply:":overlay",tag:".ply-overlay",css:{top:0,left:0,right:0,bottom:0,position:"fixed"},children:[{tag:"div",css:h({width:"100%",height:"100%"},a)}]})}function v(a,b,c){a.wrapEl=o({tag:"form",css:{whiteSpace:"nowrap",zIndex:b.zIndex}}),c||(a.overlayEl=u(b.overlay),a.overlayBoxEl=a.overlayEl.firstChild,k(a.wrapEl,a.overlayEl));var d=o();r(d,{height:"100%",display:"inline-block",verticalAlign:"middle"}),k(a.wrapEl,d);var e=b.el;return a.el=e&&e.cloneNode?e.cloneNode(!0):o({html:e||""}),a.layerEl=t(a.el,b),a.contentEl=w(a.layerEl),a.context=new y(a.layerEl),k(a.wrapEl,a.layerEl),a.bodyEl=b.body&&i(b.body)||G.body,a.wrapEl.tabIndex=-1,r(a.wrapEl,{top:0,left:0,right:0,bottom:0,position:"fixed",textAlign:"center",overflow:"auto",outline:0}),a}function w(a){return a.firstChild.lastChild.firstChild}function x(a,b){b=a instanceof Object?a:b||{},b.el=b.el||a;var d=this;d.cid="c"+D++,N.zIndex++,d.options=b=h({},N,b),b.flags=h({},N.flags,b.flags),v(d,b),d.setEffect(b.effect),d.fx=function(a){return!(d.fx.queue=d.fx.queue.then(a,a).then(function(){return d}))},d.fx.queue=c(),d.on("click",":overlay",function(){d.hasFlag("closeByOverlay")&&d.closeBy("overlay")}),d.on("click",":close",function(a,b){a.preventDefault(),d.closeBy("BUTTON"===b.nodeName?"cancel":"x")}),d.options.oninit(this)}function y(a){this.el=a}function z(a,b){return null==a?{skip:!0}:("string"==typeof a&&(a={text:a}),"object"==typeof a&&(a.name=a.name||b),a)}function A(a,b,c){var d,e=A[a];return e||(a=a.split(/\s+/).slice(0,-1).join(" "),e=b&&(A[a+" [name="+b.name+"]"]||A[a+" [type="+b.type+"]"])||A[a+" *"]||A[":default"]),d=o(e(b,c)),b&&b.name&&d.setAttribute(L+"-name",b.name),d.className+=" ply-ui",d}function B(b,c){B["_"+b]=c,B[b]=function(b,d){return a(function(a,e){c(b,d,a,e)}).then(function(a){return a.appendChild||(a=A(":root",a)),a})}}function C(a,b,c,d){return b.mod=a,b.effect=b.effect||"slide",b.flags=h({closeBtn:!1},b.flags),{header:c.title,content:c.form?{"dialog-form":{children:c.form}}:{el:c.text||c},ctrls:{ok:c.ok||d.ok,cancel:c.cancel===!1?null:c.cancel||d.cancel}}}var D=1,E=function(){},F=window,G=F.document,H=F.setTimeout,I={ok:"OK",cancel:"Cancel",cross:"✖"},J=function(){var a={},b=G.createElement("div").style,c="opacity transition transform perspective transformStyle transformOrigin backfaceVisibility".split(" "),d=["Webkit","Moz","O","MS"];return f(c,function(c,e){if(a[c]=c in b&&c,!a[c])for(e=0;4>e;e++){var f=d[e]+c.charAt(0).toUpperCase()+c.substr(1);if(a[c]=f in b&&f)break}}),a}(),K={esc:27},L="data-ply",M=window.jQuery||window.Zepto||window.ender||window.$,N={zIndex:1e4,layer:{},overlay:{opacity:.6,backgroundColor:"rgb(0, 0, 0)"},flags:{closeBtn:!0,bodyScroll:!1,closeByEsc:!0,closeByOverlay:!0,hideLayerInStack:!0,visibleOverlayInStack:!1},baseHtml:!0,oninit:E,onopen:E,onclose:E,ondestroy:E,onaction:E},O=window.Promise,P=window.Deferred||O,Q=c();O&&!Q.always&&(P=function(a){var b=new O(a);return b.__proto__=this.__proto__,b},P.prototype=Object.create(O.prototype),P.prototype.constructor=P,P.prototype.then=function(a){var b=O.prototype.then.call(this,a);return b.__proto__=this.__proto__,b},P.prototype.done=function(a){return this.then(a),this},P.prototype.fail=function(a){return this["catch"](a),this},P.prototype.always=function(a){return this.then(a,a),this},["all","cast","reject","resolve"].forEach(function(a){P[a]=O[a]}));var R=/^(\w+)?(#\w+)?((?:\.[\w_-]+)*)/i,S={opacity:!J.opacity&&function(a,b){a.zoom=1,a.filter="alpha(opacity="+100*b+")"}};s.get=function(){return s.el||(s.el=o({tag:".ply-global-loading",children:{".ply-loading-spinner":!0}}))},x.fn=x.prototype={constructor:x,_activate:function(){if(!this.hasFlag("bodyScroll")){var a=this.bodyEl,b=o({css:{overflow:"auto",visibility:"hidden",height:"5px"},children:[{tag:"div",css:{height:"100px"}}]});this.__overflow=r(a,"overflow"),this.__paddingRight=r(a,"paddingRight"),k(a,b),r(a,{overflow:"hidden",paddingRight:b.offsetWidth-b.firstChild.offsetWidth+"px"}),l(b)}m(this.wrapEl,"submit",this._getHandleEvent("submit"))},_deactivate:function(){this.hasFlag("bodyScroll")||r(this.bodyEl,{overflow:this.__overflow,paddingRight:this.__paddingRight}),n(this.layerEl,"submit",this._getHandleEvent("submit"))},_getHandleEvent:function(a){var b=this,c=b.__handleEvent||(b.__handleEvent={});return c[a]||(c[a]=function(c){b._handleEvent(a,c)}),c[a]},_handleEvent:function(a,b){b.preventDefault(),this.closeBy(a)},$:function(a){return M(a,this.layerEl)},find:function(a){return i(a,this.layerEl)},applyEffect:function(a,b,c){return a=this[a]||a,a.nodeType||(c=b,b=a,a=this.layerEl),c=x.effects.get(c||this.effects),x.effects.apply.call(c,a,b)},closeBy:function(a){var b=this,c={by:a,state:"submit"===a,data:this.context.toJSON(),widget:this,context:this.context},e=(this.el,this.options.onaction(c));this.__lock||(this.__lock=!0,this.el.className+=" ply-loading",d(e).done(function(a){a!==!1&&(b.result=c,b.close())}).always(function(){b.__lock=!1,b.el.className=b.el.className.replace(/\s?ply-loading/,"")}))},on:function(a,b,c){var d=this;return c||(c=b,b=":layer"),c["_"+b]=function(a){var e=a.target;do if(1===e.nodeType&&e.getAttribute(L)===b)return c.call(d,a,e);while(e!==d.wrapEl&&(e=e.parentNode))},m(d.wrapEl,a,c["_"+b]),d},off:function(a,b,c){return c||(c=b,b="layer"),n(this.wrapEl,a,c["_"+b]||E),this},hasFlag:function(a){return!!this.options.flags[a]},setEffect:function(a){return this.effects=x.effects.get(a),this},_toggleState:function(a,c){var d=this,e=a?"open":"close",f=x.stack.last;return d.visible!=a&&(d.visible=a,d[a?"_activate":"_deactivate"](),x.stack[a?"add":"remove"](d),d.fx(function(){return q(d.wrapEl).then(function(){var g=x.stack.length===(a?1:0),h=f&&f.hasFlag("hideLayerInStack"),i=g||d.hasFlag("visibleOverlayInStack");return a?(!i&&l(d.overlayBoxEl),k(d.bodyEl,d.wrapEl),d.wrapEl.focus(),p(d.layerEl),h&&f.applyEffect("close.layer",c).then(function(){l(f.layerEl)})):(f=x.stack.last)&&(k(f.wrapEl,f.layerEl),f.hasFlag("hideLayerInStack")&&f.applyEffect("open.layer",c).then(function(){p(f.el)})),b([d.applyEffect(e+".layer",c),i&&d.applyEffect("overlayEl",e+".overlay",c)]).then(function(){a||(l(d.wrapEl),k(d.overlayEl,d.overlayBoxEl)),d.options["on"+e](d)})})})),d.fx.queue},open:function(a){return this.result=null,this._toggleState(!0,a)},close:function(a){return this._toggleState(!1,a)},_swap:function(a,c,d,e,f){var g=this;return g.visible?g.fx(function(){return q(c).then(function(){return e(),b([g.applyEffect(a,"close.layer",d),g.applyEffect(c,"open.layer",d)]).then(function(){l(a),f(),g.wrapEl.focus(),p(c)})})}):f(),g.fx.queue},swap:function(a,b){a=h({},this.options,a);var c=this,d=v({},a,!0),e=b||a.effect?x.effects.get(b||a.effect):c.effects,f=c.layerEl,g=d.layerEl;return c._swap(f,g,e,function(){k(c.bodyEl,c.wrapEl),k(c.bodyEl,d.wrapEl)},function(){l(d.wrapEl),k(c.wrapEl,g),c.el=d.el,c.layerEl=g,c.contentEl=w(g),c.context.el=g})},innerSwap:function(a,b){a=h({},this.options,a);var c=this,d=v({},a,!0),e=b||a.effect?x.effects.get(b||a.effect):c.effects,f=i(".ply-inside",d.layerEl),g=i(".ply-inside",c.layerEl);return c._swap(g,f,e,function(){r(g,{width:g.offsetWidth+"px",position:"absolute"}),k(g.parentNode,f)},E)},destroy:function(){l(this.wrapEl),this._deactivate(),x.stack.remove(this),this.visible=!1,this.options.ondestroy(this)}};var T=[],U=T.push,V=T.splice;return x.stack={_idx:{},last:null,length:0,_pop:function(a){var b=x.stack.last;a.keyCode===K.esc&&b.hasFlag("closeByEsc")&&b.closeBy("esc")},add:function(a){var b=U.call(this,a);this.last=a,this._idx[a.cid]=b-1,1===b&&m(G,"keyup",this._pop)},remove:function(a){var b=this._idx[a.cid];b>=0&&(V.call(this,b,1),delete this._idx[a.cid],this.last=this[this.length-1],this.last||n(G,"keyup",this._pop))}},x.effects={defaults:{duration:300,open:{layer:null,overlay:null},close:{layer:null,overlay:null}},setup:function(a){this.defaults=this.get(a)},set:function(a){h(this,a)},get:function(a){function b(a){var b=/^([\w_-]+)(?::(\d+%?))?(\[[^\]]+\])?/.exec(a)||[];return{name:b[1]||a,duration:b[2]||null,args:JSON.parse(b[3]||"null")||{}}}function c(c,d,e){var f=b(d),g=c[f.name]||e||{},h=f.duration||g.duration||c.duration||a.duration;return"string"==typeof g&&(g=b(g),delete g.args),/%/.test(g.duration)&&(g.duration=parseInt(g.duration,10)/100*h),g.duration=0|(g.duration||h),g}var d=g(this.defaults);if("string"==typeof a){var e=b(a);a=g(this[e.name]||{open:{},close:{}}),a.duration=e.duration||a.duration,a.open.args=e.args[0],a.close.args=e.args[1]}else if(a instanceof Array){var f=b(a[0]),h=b(a[1]),i=this[f.name],j=this[h.name];a={open:g(i&&i.open||{layer:a[0],overlay:a[0]}),close:g(j&&j.close||{layer:a[1],overlay:a[1]})},a.open.args=f.args[0],a.close.args=h.args[0]}else a instanceof Object||(a={});a.duration=0|(a.duration||d.duration);for(var k in{open:0,close:0}){var l=a[k]||d[k]||{};"string"==typeof l&&(l={layer:l}),l.layer=c(l,"layer",d[k].layer),l.overlay=c(l,"overlay",d[k].overlay),void 0===l.args&&delete l.args,a[k]=l}return a},apply:function(b,d){d=d.split(".");var h,i,j=this[d[0]],k=b.firstChild,l=[b.getAttribute("style"),k&&k.getAttribute("style")];return J.transition&&j&&(i=j[d[1]])&&(h=x.effects[i.name])&&(h.to||h.from)?(h=g(h),r(b,"transition","none"),r(k,"transition","none"),f(h.to,function(a,c,d){"&"===a&&(d[c]=r(b,c))}),e(h.from)?h.from(b,j.args):h.from&&r(b,h.from),a(function(a){h.width=b.offsetWidth,r(b,"transition","all "+i.duration+"ms"),r(k,"transition","all "+i.duration+"ms"),e(h.to)?h.to(b,j.args):r(b,h.to),H(a,i.duration)}).then(function(){b.setAttribute("style",l[0]),k&&k.setAttribute("style",l[1])})):c()}},x.effects.set({fade:{open:{layer:"fade-in:80%",overlay:"fade-in:100%"},close:{layer:"fade-out:60%",overlay:"fade-out:60%"}},scale:{open:{layer:"scale-in",overlay:"fade-in"},close:{layer:"scale-out",overlay:"fade-out"}},fall:{open:{layer:"fall-in",overlay:"fade-in"},close:{layer:"fall-out",overlay:"fade-out"}},slide:{open:{layer:"slide-in",overlay:"fade-in"},close:{layer:"slide-out",overlay:"fade-out"}},"3d-flip":{open:{layer:"3d-flip-in",overlay:"fade-in"},close:{layer:"3d-flip-out",overlay:"fade-out"}},"3d-sign":{open:{layer:"3d-sign-in",overlay:"fade-in"},close:{layer:"3d-sign-out",overlay:"fade-out"}},inner:{open:{layer:"inner-in"},close:{layer:"inner-out"}},"fade-in":{from:{opacity:0},to:{opacity:"&"}},"fade-out":{to:{opacity:0}},"slide-in":{from:{opacity:0,transform:"translateY(20%)"},to:{opacity:"&",transform:"translateY(0)"}},"slide-out":{to:{opacity:0,transform:"translateY(20%)"}},"fall-in":{from:{opacity:0,transform:"scale(1.3)"},to:{opacity:"&",transform:"scale(1)"}},"fall-out":{to:{opacity:0,transform:"scale(1.3)"}},"scale-in":{from:{opacity:0,transform:"scale(0.7)"},to:{opacity:"&",transform:"scale(1)"}},"scale-out":{to:{opacity:0,transform:"scale(0.7)"}},rotate3d:function(a,b,c,d,e){r(a,{perspective:"1300px"}),r(a.firstChild,{opacity:b,transform:"rotate"+c+"("+d+"deg)",transformStyle:"preserve-3d",transformOrigin:e?"50% 0":"50%"})},"3d-sign-in":{from:function(a){x.effects.rotate3d(a,0,"X",-60,"50% 0")},to:function(a){r(a.firstChild,{opacity:1,transform:"rotateX(0)"})}},"3d-sign-out":{from:function(a){x.effects.rotate3d(a,1,"X",0,"50% 0")},to:function(a){r(a.firstChild,{opacity:0,transform:"rotateX(-60deg)"})}},"3d-flip-in":{from:function(a,b){x.effects.rotate3d(a,0,"Y",b||-70)},to:function(a){r(a.firstChild,{opacity:1,transform:"rotateY(0)"})}},"3d-flip-out":{from:function(a){x.effects.rotate3d(a,1,"Y",0)},to:function(a,b){r(a.firstChild,{opacity:0,transform:"rotateY("+(b||70)+"deg)"})}},"inner-in":{from:function(a){r(a,"transform","translateX(100%)")},to:function(a){r(a,"transform","translateX(0%)")}},"inner-out":{from:function(a){r(a,"transform","translateX(0%)")},to:function(a){r(a,"transform","translateX(-100%)")}}}),y.fn=y.prototype={constructor:y,getEl:function(a){return this.el?i("["+L+'-name="'+a+'"]',this.el):void 0},val:function(a,b){var c="string"==typeof a?this.getEl(a):a;return c&&null==c.value&&(c=j(c,"input")[0]||j(c,"textarea")[0]||j(c,"select")[0]),c&&null!=b&&(c.value=b),c&&c.value||""},toJSON:function(){for(var a,b=this.el.querySelectorAll("["+L+"-name]"),c={},d=b.length;d--;)a=b[d],c[a.getAttribute(L+"-name")]=this.val(a);return c}},A.factory=function(a,b,c){A[a.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ")]=function(d,e){var g=G.createDocumentFragment();if(null!=d||":root"===a){d=c?d:z(d),f(c?d:d.children,function(b,c){var d=((e||a)+" "+c).replace(/^:\w+\s+/,""),f=A(d,z(b,c),d);k(g,f)}),c||delete d.children;var i=b(d,g);return i.appendChild||h(i,d),i}return g}},A.factory(":default",function(a,b){return a.children=b,a}),A.factory(":root",function(a){return{tag:".ply-form",className:a.mod,children:[A(":header",a.header),A(":content",a.content),a.ctrls&&A(":default",{tag:"div.ply-footer",children:a.ctrls})]}}),A.factory(":header",function(a,b){return{tag:".ply-header",text:a.text,children:b}}),A.factory(":content",function(a,b){return{tag:".ply-content",children:b}},!0),A.factory("ok",function(a){return{ply:":ok",tag:"button.ply-ctrl.ply-ok",text:a===!0?I.ok:a}}),A.factory("cancel",function(a){return{ply:":close",tag:"button.ply-ctrl.ply-cancel",type:"reset",text:a===!0?I.cancel:a}}),B.use=function(a,b,c,d,e){B["_"+a](b,c,d,e)},B("default",function(a,b,c){c(b||{})}),B("base",function(a,b,c){c(C("base",a,b))}),B("alert",function(a,b,c){c(C("alert",a,b,{ok:!0}))}),B("confirm",function(a,b,c){c(C("confirm",a,b,{ok:!0,cancel:!0}))}),B("prompt",function(a,b,c){c(C("prompt",a,b,{ok:!0,cancel:!0}))}),A.factory("dialog-form *",function(a){return{tag:"input.ply-input",type:a.type||"text",name:a.name,value:a.value,required:!0,placeholder:a.hint||a.text}}),x.create=function(a,b,c){c||(c=b,b={});var d=B[a]||B["default"];return d(b,c).then(function(a){return new x(h(b,{el:a}))})},x.open=function(a,b,c){return x.create(a,b,c).then(function(a){return a.open()})},x.dialog=function(b,c,d){return b instanceof Object?(c=c||{},a(function(a,d){var e,g,i,j=c.initState,k=b,l={},m=function(a,b){(c.progress||E)(h({name:e.$name,index:e.$index,length:o,stack:k,current:e,widget:b},a),l)},n=function(a,b,c){var d=JSON.parse(JSON.stringify(a.data));e=a,i=!0,(a.prepare||E)(d,l),x.create(a.ui||"alert",a.options||{},d).then(function(d){var e;g?e=g[/^inner/.test(b)?"innerSwap":"swap"](d,b):(g=d,e=g.open()),e.then(function(){l[a.$name].el=g.layerEl,i=!1}),c(g)})},o=0;f(k,function(a,b){j=j||b,a.effects=a.effects||{},a.$name=b,a.$index=o++,l[b]=new x.Context}),k.$length=o,n(k[j],null,function(b){m({},b),g.options.onaction=function(b){if(i)return!1;var c=b.state||"next"===e.back,f=k[e[c?"next":"back"]];return f?(n(f,e[c?"nextEffect":"backEffect"],function(a){m(b,a)}),!1):void(b.state?a:d)(b,l)}})})):(d||(d=c||{},c={}),x.open(b,c,d).then(function(b){return a(function(a,c){b.options.onclose=function(){(b.result.state?a:c)(b.result)}})}))},x.ui=A,x.factory=B,x.lang=I,x.css=r,x.cssHooks=S,x.keys=K,x.noop=E,x.each=f,x.extend=h,x.promise=a,x.Promise=P,x.support=J,x.defaults=N,x.attrName=L,x.Context=y,x.dom={build:o,append:k,remove:l,addEvent:m,removeEvent:n},x.version="0.5.0",x});
    /*! Sortable 1.4.2 - MIT | git://github.com/rubaxa/Sortable.git */
    !function(a){"use strict";"function"==typeof define&&define.amd?define(a):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=a():"undefined"!=typeof Package?Sortable=a():window.Sortable=a()}(function(){"use strict";function a(a,b){if(!a||!a.nodeType||1!==a.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(a);this.el=a,this.options=b=r({},b),a[L]=this;var c={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(a.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",ignore:"a, img",filter:null,animation:0,setData:function(a,b){a.setData("Text",b.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1};for(var d in c)!(d in b)&&(b[d]=c[d]);V(b);for(var f in this)"_"===f.charAt(0)&&(this[f]=this[f].bind(this));this.nativeDraggable=b.forceFallback?!1:P,e(a,"mousedown",this._onTapStart),e(a,"touchstart",this._onTapStart),this.nativeDraggable&&(e(a,"dragover",this),e(a,"dragenter",this)),T.push(this._onDragOver),b.store&&this.sort(b.store.get(this))}function b(a){v&&v.state!==a&&(h(v,"display",a?"none":""),!a&&v.state&&w.insertBefore(v,s),v.state=a)}function c(a,b,c){if(a){c=c||N,b=b.split(".");var d=b.shift().toUpperCase(),e=new RegExp("\\s("+b.join("|")+")(?=\\s)","g");do if(">*"===d&&a.parentNode===c||(""===d||a.nodeName.toUpperCase()==d)&&(!b.length||((" "+a.className+" ").match(e)||[]).length==b.length))return a;while(a!==c&&(a=a.parentNode))}return null}function d(a){a.dataTransfer&&(a.dataTransfer.dropEffect="move"),a.preventDefault()}function e(a,b,c){a.addEventListener(b,c,!1)}function f(a,b,c){a.removeEventListener(b,c,!1)}function g(a,b,c){if(a)if(a.classList)a.classList[c?"add":"remove"](b);else{var d=(" "+a.className+" ").replace(K," ").replace(" "+b+" "," ");a.className=(d+(c?" "+b:"")).replace(K," ")}}function h(a,b,c){var d=a&&a.style;if(d){if(void 0===c)return N.defaultView&&N.defaultView.getComputedStyle?c=N.defaultView.getComputedStyle(a,""):a.currentStyle&&(c=a.currentStyle),void 0===b?c:c[b];b in d||(b="-webkit-"+b),d[b]=c+("string"==typeof c?"":"px")}}function i(a,b,c){if(a){var d=a.getElementsByTagName(b),e=0,f=d.length;if(c)for(;f>e;e++)c(d[e],e);return d}return[]}function j(a,b,c,d,e,f,g){var h=N.createEvent("Event"),i=(a||b[L]).options,j="on"+c.charAt(0).toUpperCase()+c.substr(1);h.initEvent(c,!0,!0),h.to=b,h.from=e||b,h.item=d||b,h.clone=v,h.oldIndex=f,h.newIndex=g,b.dispatchEvent(h),i[j]&&i[j].call(a,h)}function k(a,b,c,d,e,f){var g,h,i=a[L],j=i.options.onMove;return g=N.createEvent("Event"),g.initEvent("move",!0,!0),g.to=b,g.from=a,g.dragged=c,g.draggedRect=d,g.related=e||b,g.relatedRect=f||b.getBoundingClientRect(),a.dispatchEvent(g),j&&(h=j.call(i,g)),h}function l(a){a.draggable=!1}function m(){R=!1}function n(a,b){var c=a.lastElementChild,d=c.getBoundingClientRect();return(b.clientY-(d.top+d.height)>5||b.clientX-(d.right+d.width)>5)&&c}function o(a){for(var b=a.tagName+a.className+a.src+a.href+a.textContent,c=b.length,d=0;c--;)d+=b.charCodeAt(c);return d.toString(36)}function p(a){var b=0;if(!a||!a.parentNode)return-1;for(;a&&(a=a.previousElementSibling);)"TEMPLATE"!==a.nodeName.toUpperCase()&&b++;return b}function q(a,b){var c,d;return function(){void 0===c&&(c=arguments,d=this,setTimeout(function(){1===c.length?a.call(d,c[0]):a.apply(d,c),c=void 0},b))}}function r(a,b){if(a&&b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}var s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J={},K=/\s+/g,L="Sortable"+(new Date).getTime(),M=window,N=M.document,O=M.parseInt,P=!!("draggable"in N.createElement("div")),Q=function(a){return a=N.createElement("x"),a.style.cssText="pointer-events:auto","auto"===a.style.pointerEvents}(),R=!1,S=Math.abs,T=([].slice,[]),U=q(function(a,b,c){if(c&&b.scroll){var d,e,f,g,h=b.scrollSensitivity,i=b.scrollSpeed,j=a.clientX,k=a.clientY,l=window.innerWidth,m=window.innerHeight;if(z!==c&&(y=b.scroll,z=c,y===!0)){y=c;do if(y.offsetWidth<y.scrollWidth||y.offsetHeight<y.scrollHeight)break;while(y=y.parentNode)}y&&(d=y,e=y.getBoundingClientRect(),f=(S(e.right-j)<=h)-(S(e.left-j)<=h),g=(S(e.bottom-k)<=h)-(S(e.top-k)<=h)),f||g||(f=(h>=l-j)-(h>=j),g=(h>=m-k)-(h>=k),(f||g)&&(d=M)),(J.vx!==f||J.vy!==g||J.el!==d)&&(J.el=d,J.vx=f,J.vy=g,clearInterval(J.pid),d&&(J.pid=setInterval(function(){d===M?M.scrollTo(M.pageXOffset+f*i,M.pageYOffset+g*i):(g&&(d.scrollTop+=g*i),f&&(d.scrollLeft+=f*i))},24)))}},30),V=function(a){var b=a.group;b&&"object"==typeof b||(b=a.group={name:b}),["pull","put"].forEach(function(a){a in b||(b[a]=!0)}),a.groups=" "+b.name+(b.put.join?" "+b.put.join(" "):"")+" "};return a.prototype={constructor:a,_onTapStart:function(a){var b=this,d=this.el,e=this.options,f=a.type,g=a.touches&&a.touches[0],h=(g||a).target,i=h,k=e.filter;if(!("mousedown"===f&&0!==a.button||e.disabled)&&(h=c(h,e.draggable,d))){if(D=p(h),"function"==typeof k){if(k.call(this,a,h,this))return j(b,i,"filter",h,d,D),void a.preventDefault()}else if(k&&(k=k.split(",").some(function(a){return a=c(i,a.trim(),d),a?(j(b,a,"filter",h,d,D),!0):void 0})))return void a.preventDefault();(!e.handle||c(i,e.handle,d))&&this._prepareDragStart(a,g,h)}},_prepareDragStart:function(a,b,c){var d,f=this,h=f.el,j=f.options,k=h.ownerDocument;c&&!s&&c.parentNode===h&&(G=a,w=h,s=c,t=s.parentNode,x=s.nextSibling,F=j.group,d=function(){f._disableDelayedDrag(),s.draggable=!0,g(s,f.options.chosenClass,!0),f._triggerDragStart(b)},j.ignore.split(",").forEach(function(a){i(s,a.trim(),l)}),e(k,"mouseup",f._onDrop),e(k,"touchend",f._onDrop),e(k,"touchcancel",f._onDrop),j.delay?(e(k,"mouseup",f._disableDelayedDrag),e(k,"touchend",f._disableDelayedDrag),e(k,"touchcancel",f._disableDelayedDrag),e(k,"mousemove",f._disableDelayedDrag),e(k,"touchmove",f._disableDelayedDrag),f._dragStartTimer=setTimeout(d,j.delay)):d())},_disableDelayedDrag:function(){var a=this.el.ownerDocument;clearTimeout(this._dragStartTimer),f(a,"mouseup",this._disableDelayedDrag),f(a,"touchend",this._disableDelayedDrag),f(a,"touchcancel",this._disableDelayedDrag),f(a,"mousemove",this._disableDelayedDrag),f(a,"touchmove",this._disableDelayedDrag)},_triggerDragStart:function(a){a?(G={target:s,clientX:a.clientX,clientY:a.clientY},this._onDragStart(G,"touch")):this.nativeDraggable?(e(s,"dragend",this),e(w,"dragstart",this._onDragStart)):this._onDragStart(G,!0);try{N.selection?N.selection.empty():window.getSelection().removeAllRanges()}catch(b){}},_dragStarted:function(){w&&s&&(g(s,this.options.ghostClass,!0),a.active=this,j(this,w,"start",s,w,D))},_emulateDragOver:function(){if(H){if(this._lastX===H.clientX&&this._lastY===H.clientY)return;this._lastX=H.clientX,this._lastY=H.clientY,Q||h(u,"display","none");var a=N.elementFromPoint(H.clientX,H.clientY),b=a,c=" "+this.options.group.name,d=T.length;if(b)do{if(b[L]&&b[L].options.groups.indexOf(c)>-1){for(;d--;)T[d]({clientX:H.clientX,clientY:H.clientY,target:a,rootEl:b});break}a=b}while(b=b.parentNode);Q||h(u,"display","")}},_onTouchMove:function(b){if(G){a.active||this._dragStarted(),this._appendGhost();var c=b.touches?b.touches[0]:b,d=c.clientX-G.clientX,e=c.clientY-G.clientY,f=b.touches?"translate3d("+d+"px,"+e+"px,0)":"translate("+d+"px,"+e+"px)";I=!0,H=c,h(u,"webkitTransform",f),h(u,"mozTransform",f),h(u,"msTransform",f),h(u,"transform",f),b.preventDefault()}},_appendGhost:function(){if(!u){var a,b=s.getBoundingClientRect(),c=h(s),d=this.options;u=s.cloneNode(!0),g(u,d.ghostClass,!1),g(u,d.fallbackClass,!0),h(u,"top",b.top-O(c.marginTop,10)),h(u,"left",b.left-O(c.marginLeft,10)),h(u,"width",b.width),h(u,"height",b.height),h(u,"opacity","0.8"),h(u,"position","fixed"),h(u,"zIndex","100000"),h(u,"pointerEvents","none"),d.fallbackOnBody&&N.body.appendChild(u)||w.appendChild(u),a=u.getBoundingClientRect(),h(u,"width",2*b.width-a.width),h(u,"height",2*b.height-a.height)}},_onDragStart:function(a,b){var c=a.dataTransfer,d=this.options;this._offUpEvents(),"clone"==F.pull&&(v=s.cloneNode(!0),h(v,"display","none"),w.insertBefore(v,s)),b?("touch"===b?(e(N,"touchmove",this._onTouchMove),e(N,"touchend",this._onDrop),e(N,"touchcancel",this._onDrop)):(e(N,"mousemove",this._onTouchMove),e(N,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,50)):(c&&(c.effectAllowed="move",d.setData&&d.setData.call(this,c,s)),e(N,"drop",this),setTimeout(this._dragStarted,0))},_onDragOver:function(a){var d,e,f,g=this.el,i=this.options,j=i.group,l=j.put,o=F===j,p=i.sort;if(void 0!==a.preventDefault&&(a.preventDefault(),!i.dragoverBubble&&a.stopPropagation()),I=!0,F&&!i.disabled&&(o?p||(f=!w.contains(s)):F.pull&&l&&(F.name===j.name||l.indexOf&&~l.indexOf(F.name)))&&(void 0===a.rootEl||a.rootEl===this.el)){if(U(a,i,this.el),R)return;if(d=c(a.target,i.draggable,g),e=s.getBoundingClientRect(),f)return b(!0),void(v||x?w.insertBefore(s,v||x):p||w.appendChild(s));if(0===g.children.length||g.children[0]===u||g===a.target&&(d=n(g,a))){if(d){if(d.animated)return;r=d.getBoundingClientRect()}b(o),k(w,g,s,e,d,r)!==!1&&(s.contains(g)||(g.appendChild(s),t=g),this._animate(e,s),d&&this._animate(r,d))}else if(d&&!d.animated&&d!==s&&void 0!==d.parentNode[L]){A!==d&&(A=d,B=h(d),C=h(d.parentNode));var q,r=d.getBoundingClientRect(),y=r.right-r.left,z=r.bottom-r.top,D=/left|right|inline/.test(B.cssFloat+B.display)||"flex"==C.display&&0===C["flex-direction"].indexOf("row"),E=d.offsetWidth>s.offsetWidth,G=d.offsetHeight>s.offsetHeight,H=(D?(a.clientX-r.left)/y:(a.clientY-r.top)/z)>.5,J=d.nextElementSibling,K=k(w,g,s,e,d,r);if(K!==!1){if(R=!0,setTimeout(m,30),b(o),1===K||-1===K)q=1===K;else if(D){var M=s.offsetTop,N=d.offsetTop;q=M===N?d.previousElementSibling===s&&!E||H&&E:N>M}else q=J!==s&&!G||H&&G;s.contains(g)||(q&&!J?g.appendChild(s):d.parentNode.insertBefore(s,q?J:d)),t=s.parentNode,this._animate(e,s),this._animate(r,d)}}}},_animate:function(a,b){var c=this.options.animation;if(c){var d=b.getBoundingClientRect();h(b,"transition","none"),h(b,"transform","translate3d("+(a.left-d.left)+"px,"+(a.top-d.top)+"px,0)"),b.offsetWidth,h(b,"transition","all "+c+"ms"),h(b,"transform","translate3d(0,0,0)"),clearTimeout(b.animated),b.animated=setTimeout(function(){h(b,"transition",""),h(b,"transform",""),b.animated=!1},c)}},_offUpEvents:function(){var a=this.el.ownerDocument;f(N,"touchmove",this._onTouchMove),f(a,"mouseup",this._onDrop),f(a,"touchend",this._onDrop),f(a,"touchcancel",this._onDrop)},_onDrop:function(b){var c=this.el,d=this.options;clearInterval(this._loopId),clearInterval(J.pid),clearTimeout(this._dragStartTimer),f(N,"mousemove",this._onTouchMove),this.nativeDraggable&&(f(N,"drop",this),f(c,"dragstart",this._onDragStart)),this._offUpEvents(),b&&(I&&(b.preventDefault(),!d.dropBubble&&b.stopPropagation()),u&&u.parentNode.removeChild(u),s&&(this.nativeDraggable&&f(s,"dragend",this),l(s),g(s,this.options.ghostClass,!1),g(s,this.options.chosenClass,!1),w!==t?(E=p(s),E>=0&&(j(null,t,"sort",s,w,D,E),j(this,w,"sort",s,w,D,E),j(null,t,"add",s,w,D,E),j(this,w,"remove",s,w,D,E))):(v&&v.parentNode.removeChild(v),s.nextSibling!==x&&(E=p(s),E>=0&&(j(this,w,"update",s,w,D,E),j(this,w,"sort",s,w,D,E)))),a.active&&((null===E||-1===E)&&(E=D),j(this,w,"end",s,w,D,E),this.save())),w=s=t=u=x=v=y=z=G=H=I=E=A=B=F=a.active=null)},handleEvent:function(a){var b=a.type;"dragover"===b||"dragenter"===b?s&&(this._onDragOver(a),d(a)):("drop"===b||"dragend"===b)&&this._onDrop(a)},toArray:function(){for(var a,b=[],d=this.el.children,e=0,f=d.length,g=this.options;f>e;e++)a=d[e],c(a,g.draggable,this.el)&&b.push(a.getAttribute(g.dataIdAttr)||o(a));return b},sort:function(a){var b={},d=this.el;this.toArray().forEach(function(a,e){var f=d.children[e];c(f,this.options.draggable,d)&&(b[a]=f)},this),a.forEach(function(a){b[a]&&(d.removeChild(b[a]),d.appendChild(b[a]))})},save:function(){var a=this.options.store;a&&a.set(this)},closest:function(a,b){return c(a,b||this.options.draggable,this.el)},option:function(a,b){var c=this.options;return void 0===b?c[a]:(c[a]=b,void("group"===a&&V(c)))},destroy:function(){var a=this.el;a[L]=null,f(a,"mousedown",this._onTapStart),f(a,"touchstart",this._onTapStart),this.nativeDraggable&&(f(a,"dragover",this),f(a,"dragenter",this)),Array.prototype.forEach.call(a.querySelectorAll("[draggable]"),function(a){a.removeAttribute("draggable")}),T.splice(T.indexOf(this._onDragOver),1),this._onDrop(),this.el=a=null}},a.utils={on:e,off:f,css:h,find:i,is:function(a,b){return!!c(a,b,a)},extend:r,throttle:q,closest:c,toggleClass:g,index:p},a.create=function(b,c){return new a(b,c)},a.version="1.4.2",a});

    var colList = [];
    var colIds = [];
    var colSortable = [];
    var bmkList = [];
    var bmkIds = [];
    var bmkSortable = [];
    // ✎ &#9998; ✚ &#10010; ✖ &#10006;
    var btns = '<i class="rename_cate" onclick="renameCategory(this)">&#9998;</i><i class="add_bmk" onclick="addBookmark(this)">&#10010;</i><i class="del_cate" >&#10006;</i>';

    // Init 6 columns as Sortable
    function initColumns() {
      colList = document.getElementsByClassName("column");
      colIds = [];
      colSortable = [];
      for (i = 0; i < colList.length; i++) {
        colList[i].id = 'col' + i;
        colIds[i] = 'col' + i;
      };
      for (i = 0; i < colList.length; i++) {
        colSortable[i] = Sortable.create(colList[i], {
          group: {name: colIds[i], pull: colIds, put: colIds},
          animation: 300,
          filter: '.del_cate',
          onFilter: function (evt) {
            evt.item.parentNode.removeChild(evt.item);
          }
        });
      };
    };

    // Init bookmark lists as Sortable
    function initBookmarks() {
      bmkList = document.getElementsByClassName("bmk_list");
      bmkIds = [];
      bmkSortable = [];
      for (i = 0; i < bmkList.length; i++) {
        bmkList[i].id = 'bmk' + i;
        bmkIds[i] = 'bmk' + i;
      };
      for (i = 0; i < bmkList.length; i++) {
        bmkSortable[i] = Sortable.create(bmkList[i], {
          group: {name: bmkIds[i], pull: bmkIds, put: bmkIds},
          animation: 300,
          filter: '.del_bmk',
          onFilter: function (evt) {
            evt.item.parentNode.removeChild(evt.item);
          }
        });
      };
    };

    initColumns();
    initBookmarks();

    // Add a bookmark to a category
    function addBookmark(btn) {
      var cat = btn.parentNode.parentNode.children[1];
      Ply.dialog('prompt', {
        title: 'Add Bookmark',
        form: { name: 'Name', url: 'URL' }
      }).done(function (ui) {
        if (ui.data.name.trim().length) {
          var el = document.createElement('li');
          if (ui.data.url.trim().length) {
            if (ui.data.url.indexOf('://') == -1) {
              ui.data.url = 'http://' + ui.data.url;
            };
            el.innerHTML = '<a href="' + ui.data.url + '">' + ui.data.name + '</a>';
          } else {
            el.innerHTML = ui.data.name;
          };
          el.innerHTML += '<i class="del_bmk">&#10006;</i>'; //✖ &#10006;
          cat.appendChild(el);
        };
      });
    };

    // Rename a category
    function renameCategory(obj) {
      var h1 = obj.parentNode;
      Ply.dialog('prompt', {
        title: 'Rename Category',
        form: { name: 'Name' }
      }).done(function (ui) {
        h1.innerHTML = ui.data.name.trim() + btns;
      });
    };

    // Add a category to the leftmost column on the page
    document.getElementById('btnAddCategory').onclick = function () {
      var el = document.createElement('div');
      el.className = 'category';
      el.innerHTML = '<h1>New Category' + btns + '</h1><ul class="bmk_list"></ul>';
      colSortable[0].el.appendChild(el);
      initBookmarks();
    };

    // Save the updated page to a local html file
    document.getElementById('btnSaveAs').onclick = function () {
      var code = document.documentElement.innerHTML;
      code = '<!doctype html>\n<html>\n' + code + '\n</html>\n';
      var blob = new Blob([code], {type: 'text/plain;charset=utf-8'});
      saveAs(blob, 'index.html');
    };

  </script>
</body>
</html>
